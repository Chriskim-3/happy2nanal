<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>개발자 도우미</title>
    <style>
        @font-face {
            font-family: 'GmarketSansMedium';
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2001@1.1/GmarketSansMedium.woff') format('woff');
            font-weight: normal;
            font-style: normal;
        }

        body {
            font-family: 'GmarketSansMedium', sans-serif;
            margin: 0;
            padding: 0;
            font-size: 16px;
        }
        .header {
            background-color: #f0f0f0;
            padding: 20px;
            text-align: center;
        }
        .support-message {
            color: #006994;
            margin-bottom: 5px;
            font-size: 1.2em;
        }
        .main-title {
            color: #333;
            font-size: 1.8em;
            font-weight: bold;
        }
        .menu-bar {
            background-color: #333;
            overflow: visible;
            padding: 0 20px;
            position: relative;
            z-index: 1000;
        }
        .menu-bar a, .dropdown .dropbtn {
            float: left;
            color: white;
            text-align: center;
            padding: 14px 16px;
            text-decoration: none;
            font-size: 14px;
            transition: 0.3s;
        }
        .dropdown {
            position: relative;
            display: inline-block;
        }
        .dropdown .dropbtn {
            border: none;
            outline: none;
            background-color: inherit;
            font-family: inherit;
            margin: 0;
        }
        .menu-bar a:hover, .dropdown:hover .dropbtn {
            background-color: #555;
        }
        .dropdown-content {
            display: none;
            position: absolute;
            border-radius: 8px;
            background-color: rgba(249, 249, 249, 0.9);
            top: 100%;
            left: 0;
          /*  background-color: #f9f9f9; */
            min-width: 160px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 10001;
        }
        .dropdown-content a {
            float: none;
            border-radius: 8px;
            
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
            text-align: left;
        }
        .dropdown-content a:hover {
            background-color: #ddd;
        }
        .dropdown:hover .dropdown-content {
            display: block;
        }
        .content {
            margin: 20px;
            padding-bottom: 60px;
            position: relative;
            z-index: 1;
        }

        .main {
            padding: 20px;
        }
        .footer {
            background-color: #333;
            color: white;
            text-align: center;
            padding: 10px;
            position: fixed;
            bottom: 0;
            width: 100%;
        }
        .search-bar {
            display: inline-block;
        }
        #editor, #editEditor, #studyContent, #noticeContent {
            width: 100%;
            height: 300px;
            margin-bottom: 10px;
            padding: 10px;
            box-sizing: border-box;
        }
        #postList, #noticeList, #studyList {
            list-style-type: none;
            padding: 0;
        }
        #postList li, #noticeList li, #studyList li {
            cursor: pointer;
            padding: 10px;
            border-bottom: 1px solid #ddd;
        }
        #postList li:hover, #noticeList li:hover, #studyList li:hover {
            background-color: #f5f5f5;
        }
        .button-container {
            text-align: center;
            margin-top: 20px;
        }
        .button-container button {
            margin: 0 5px;
            padding: 10px 20px;
        }
        h2 {
            font-size: 1.5em;
        }
        h3 {
            font-size: 1.2em;
            margin-top: 10px;
        }
        #studyTitle, #noticeTitle, #postTitle {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            box-sizing: border-box;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="support-message">당신의 칼퇴를 응원합니다!</div>
        <div class="main-title">행복한 나날들이어라고</div>
    </div>

    <div class="menu-bar">
        <div class="dropdown">
            <button class="dropbtn">소개</button>
            <div class="dropdown-content">
                <a href="#" onclick="showContent('이 홈페이지는 글쓰고, 올리고, 지울려고 만드는 사이트 입니다.')">이 홈페이지는</a>
                <a href="#" onclick="showContent('이 사이트는 깃헙을 바탕으로 만들어졌습니다')">참고하세요</a>
                <a href="#" onclick="showContent('김상수가 만들었습니다')">라이센스</a>
            </div>
        </div>
        <div class="dropdown">
            <button class="dropbtn">코딩공부</button>
            <div class="dropdown-content">
                <a href="#" onclick="showStudyList('오토핫키')">오토핫키</a>
                <a href="#" onclick="showStudyList('자바스크립트')">자바스크립트</a>
                <a href="#" onclick="showStudyList('파이썬')">파이썬</a>
                <a href="#" onclick="showStudyList('인디자인')">요약모음</a>
            </div>
        </div>
        <div class="dropdown">
            <button class="dropbtn">게시판</button>
            <div class="dropdown-content">
                <a href="#" onclick="showQnAList()">Q&A</a>
                <a href="#" onclick="showNoticeList()">공지사항</a>
                <a href="#" onclick="showFileUpload()">자료실</a>
            </div>
        </div>
    </div>

    <div class="content">
        <div class="main" id="mainContent">
            <!-- 여기에 메뉴 선택에 따른 내용이 표시됩니다 -->
        </div>
    </div>

    <div class="footer">
        <p>&copy; 2024 개발자 도우미. All rights reserved.</p>
    </div>

    <script>
        let posts = JSON.parse(localStorage.getItem('posts')) || [];
        let notices = JSON.parse(localStorage.getItem('notices')) || [];
        let files = JSON.parse(localStorage.getItem('files')) || [];
        let studyContents = JSON.parse(localStorage.getItem('studyContents')) || [];

        function showContent(content) {
            document.getElementById('mainContent').innerHTML = `<p>${content}</p>`;
        }

        function showStudyList(topic) {
            let listHtml = `<h2>${topic} 학습 내용</h2>`;
            
            // 목록 표시
            listHtml += '<ul id="studyList">';
            studyContents.filter(item => item.topic === topic).forEach((item, index) => {
                listHtml += `
                    <li onclick="viewStudyContent(${studyContents.indexOf(item)})">
                        <h3>${item.title}</h3>
                    </li>`;
            });
            listHtml += '</ul>';

            // 검색 기능과 글쓰기 버튼을 목록 아래에 배치
            listHtml += `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 10px;">
                    <div class="search-container">
                        <input type="text" id="studySearchInput" placeholder="검색...">
                        <button onclick="searchStudy('${topic}')">검색</button>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 10px;">
                    <button onclick="showStudyForm('${topic}')">글쓰기</button>
                </div>
            `;

            document.getElementById('mainContent').innerHTML = listHtml;
        }

        function showStudyForm(topic) {
            document.getElementById('mainContent').innerHTML = `
                <h3>${topic} 내용 추가</h3>
                <input type="text" id="studyTitle" placeholder="제목을 입력하세요">
                <textarea id="studyContent" placeholder="내용을 입력하세요..."></textarea>
                <div class="button-container">
                                         <button onclick="saveStudyContent('${topic}')">저장</button>
                </div>
            `;
        }

        function saveStudyContent(topic) {
            const title = document.getElementById('studyTitle').value;
            const content = document.getElementById('studyContent').value;
            if (title && content) {
                studyContents.push({topic, title, content});
                localStorage.setItem('studyContents', JSON.stringify(studyContents));
                showStudyList(topic);
            }
        }

        function viewStudyContent(index) {
            const item = studyContents[index];
            let content = `
                <h2>${item.title}</h2>
                <div>${item.content}</div>
                <div class="button-container">
                    <button onclick="editStudyContent(${index})">수정</button>
                    <button onclick="deleteStudyContent(${index})">삭제</button>
                    <button onclick="showStudyList('${item.topic}')">목록으로</button>
                </div>
            `;
            pushState(content);
        }

        function editStudyContent(index) {
            const item = studyContents[index];
            document.getElementById('mainContent').innerHTML = `
                <h3>학습 내용 수정</h3>
                <input type="text" id="studyTitle" value="${item.title}">
                <textarea id="studyContent">${item.content}</textarea>
                <div class="button-container">
                    <button onclick="updateStudyContent(${index})">업데이트</button>
                    <button onclick="showStudyList('${item.topic}')">취소</button>
                </div>
            `;
        }

        function updateStudyContent(index) {
            const title = document.getElementById('studyTitle').value;
            const content = document.getElementById('studyContent').value;
            if (title && content) {
                studyContents[index] = {topic: studyContents[index].topic, title, content};
                localStorage.setItem('studyContents', JSON.stringify(studyContents));
                viewStudyContent(index);
            }
        }

        function deleteStudyContent(index) {
            if (confirm('정말로 이 학습 내용을 삭제하시겠습니까?')) {
                const topic = studyContents[index].topic;
                studyContents.splice(index, 1);
                localStorage.setItem('studyContents', JSON.stringify(studyContents));
                showStudyList(topic);
            }
        }

        function searchStudy(topic) {
            const searchTerm = document.getElementById('studySearchInput').value.toLowerCase();
            const results = studyContents.filter(item => 
                item.topic === topic && (item.title.toLowerCase().includes(searchTerm) || item.content.toLowerCase().includes(searchTerm))
            );
            let resultHtml = `<h3>${topic} 검색 결과</h3><ul>`;
            results.forEach((item, index) => {
                resultHtml += `<li onclick="viewStudyContent(${studyContents.indexOf(item)})">${item.title}</li>`;
            });
            resultHtml += '</ul>';
            document.getElementById('mainContent').innerHTML = resultHtml;
            pushState(resultHtml);
        }

        function showQnAList() {
            let listHtml = '<h3>Q&A 목록</h3><ul id="postList">';
            posts.forEach((post, index) => {
                listHtml += `<li onclick="viewPost(${index})">${post.title}</li>`;
            });
            listHtml += '</ul>';
            listHtml += `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 10px;">
                    <div class="button-container">
                        <button onclick="showQnAForm()">글쓰기</button>
                    </div>
                    <div class="search-container">
                        <input type="text" id="qnaSearchInput" placeholder="검색...">
                        <button onclick="searchQnA()">검색</button>
                    </div>
                </div>
            `;
            document.getElementById('mainContent').innerHTML = listHtml;
            pushState(listHtml);
        }

        function showQnAForm() {
            document.getElementById('mainContent').innerHTML = `
                <h3>Q&A 글쓰기</h3>
                <input type="text" id="postTitle" placeholder="제목을 입력하세요">
                <textarea id="editor" placeholder="여기에 글을 작성하세요..."></textarea>
                <div class="button-container">
                    <button onclick="savePost()">저장</button>
                </div>
            `;
        }

        function savePost() {
            const title = document.getElementById('postTitle').value;
            const content = document.getElementById('editor').value;
            if (title && content) {
                posts.push({title, content});
                localStorage.setItem('posts', JSON.stringify(posts));
                showQnAList();
            }
        }

        function viewPost(index) {
            const post = posts[index];
            let content = `
                <h3>${post.title}</h3>
                <p>${post.content}</p>
                <div class="button-container">
                    <button onclick="editPost(${index})">수정</button>
                    <button onclick="deletePost(${index})">삭제</button>
                    <button onclick="showQnAList()">목록으로</button>
                </div>
            `;
            pushState(content);
        }

        function editPost(index) {
            const post = posts[index];
            document.getElementById('mainContent').innerHTML = `
                <h3>게시글 수정</h3>
                <input type="text" id="editTitle" value="${post.title}">
                <textarea id="editEditor">${post.content}</textarea>
                <div class="button-container">
                    <button onclick="updatePost(${index})">업데이트</button>
                    <button onclick="showQnAList()">취소</button>
                </div>
            `;
        }

        function updatePost(index) {
            const title = document.getElementById('editTitle').value;
            const content = document.getElementById('editEditor').value;
            if (title && content) {
                posts[index] = {title, content};
                localStorage.setItem('posts', JSON.stringify(posts));
                viewPost(index);
            }
        }

        function deletePost(index) {
            if (confirm('정말로 이 게시글을 삭제하시겠습니까?')) {
                posts.splice(index, 1);
                localStorage.setItem('posts', JSON.stringify(posts));
                showQnAList();
            }
        }

        function searchQnA() {
            const searchTerm = document.getElementById('qnaSearchInput').value.toLowerCase();
            const results = posts.filter(post => 
                post.title.toLowerCase().includes(searchTerm) || 
                post.content.toLowerCase().includes(searchTerm)
            );
            let resultHtml = '<h3>Q&A 검색 결과</h3><ul>';
            results.forEach((post, index) => {
                resultHtml += `<li onclick="viewPost(${posts.indexOf(post)})">${post.title}</li>`;
            });
            resultHtml += '</ul>';
            document.getElementById('mainContent').innerHTML = resultHtml;
            pushState(resultHtml);
        }

        function showNoticeList() {
            let listHtml = '<h3>공지사항</h3><ul id="noticeList">';
            notices.forEach((notice, index) => {
                listHtml += `<li onclick="viewNotice(${index})">${notice.title}</li>`;
            });
            listHtml += '</ul>';
            listHtml += `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 10px;">
                    <div class="button-container">
                        <button onclick="showNoticePasswordForm()">공지사항 작성</button>
                    </div>
                    <div class="search-container">
                        <input type="text" id="noticeSearchInput" placeholder="검색...">
                        <button onclick="searchNotice()">검색</button>
                    </div>
                </div>
            `;
            document.getElementById('mainContent').innerHTML = listHtml;
            pushState(listHtml);
        }

        function showNoticePasswordForm() {
            document.getElementById('mainContent').innerHTML = `
                <h3>비밀번호 입력</h3>
                <input type="password" id="noticePassword" placeholder="비밀번호를 입력하세요">
                <div class="button-container">
                    <button onclick="checkNoticePassword()">확인</button>
                </div>
            `;
        }

        function checkNoticePassword() {
            const password = document.getElementById('noticePassword').value;
            if (password === '369369') {
                showNoticeForm();
            } else {
                alert('비밀번호가 올바르지 않습니다.');
            }
        }

        function showNoticeForm() {
            document.getElementById('mainContent').innerHTML = `
                <h3>공지사항 작성</h3>
                <input type="text" id="noticeTitle" placeholder="제목을 입력하세요">
                <textarea id="noticeContent" placeholder="내용을 입력하세요..."></textarea>
                <div class="button-container">
                    <button onclick="saveNotice()">저장</button>
                </div>
            `;
        }

        function saveNotice() {
            const title = document.getElementById('noticeTitle').value;
            const content = document.getElementById('noticeContent').value;
            if (title && content) {
                notices.push({title, content});
                localStorage.setItem('notices', JSON.stringify(notices));
                showNoticeList();
            } else {
                alert('제목과 내용을 모두 입력해주세요.');
            }
        }

        function viewNotice(index) {
            const notice = notices[index];
            let content = `
                <h3>${notice.title}</h3>
                <p>${notice.content}</p>
                <div class="button-container">
                    <button onclick="showNoticeList()">목록으로</button>
                </div>
            `;
            pushState(content);
        }

        function searchNotice() {
            const searchTerm = document.getElementById('noticeSearchInput').value.toLowerCase();
            const results = notices.filter(notice => 
                notice.title.toLowerCase().includes(searchTerm) || 
                notice.content.toLowerCase().includes(searchTerm)
            );
            let resultHtml = '<h3>공지사항 검색 결과</h3><ul>';
            results.forEach((notice, index) => {
                resultHtml += `<li onclick="viewNotice(${notices.indexOf(notice)})">${notice.title}</li>`;
            });
            resultHtml += '</ul>';
            document.getElementById('mainContent').innerHTML = resultHtml;
            pushState(resultHtml);
        }

        function showFileUpload() {
            document.getElementById('mainContent').innerHTML = `
                <h3>자료실</h3>
                <input type="file" id="fileInput">
                <div class="button-container">
                    <button onclick="uploadFile()">업로드</button>
                </div>
                <h3>업로드된 파일 목록</h3>
                <ul id="fileList"></ul>
            `;
            updateFileList();
        }

        function uploadFile() {
            const fileInput = document.getElementById('fileInput');
            const file = fileInput.files[0];
            if (file) {
                files.push(file.name);
                localStorage.setItem('files', JSON.stringify(files));
                updateFileList();
            }
        }

        function updateFileList() {
            const fileList = document.getElementById('fileList');
            fileList.innerHTML = '';
            files.forEach(file => {
                const li = document.createElement('li');
                li.textContent = file;
                fileList.appendChild(li);
            });
        }

        function search() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            let resultHtml = '<h3>전체 검색 결과</h3>';

            // Q&A 검색
            const qnaResults = posts.filter(post => 
                post.title.toLowerCase().includes(searchTerm) || 
                post.content.toLowerCase().includes(searchTerm)
            );
            if (qnaResults.length > 0) {
                resultHtml += '<h4>Q&A 결과</h4><ul>';
                qnaResults.forEach((post, index) => {
                    resultHtml += `<li onclick="viewPost(${posts.indexOf(post)})">${post.title}</li>`;
                });
                resultHtml += '</ul>';
            }

            // 공지사항 검색
            const noticeResults = notices.filter(notice => 
                notice.title.toLowerCase().includes(searchTerm) || 
                notice.content.toLowerCase().includes(searchTerm)
            );
            if (noticeResults.length > 0) {
                resultHtml += '<h4>공지사항 결과</h4><ul>';
                noticeResults.forEach((notice, index) => {
                    resultHtml += `<li onclick="viewNotice(${notices.indexOf(notice)})">${notice.title}</li>`;
                });
                resultHtml += '</ul>';
            }

            // 코딩공부 검색
            const studyResults = studyContents.filter(item => 
                item.title.toLowerCase().includes(searchTerm) || 
                item.content.toLowerCase().includes(searchTerm)
            );
            if (studyResults.length > 0) {
                resultHtml += '<h4>코딩공부 결과</h4><ul>';
                studyResults.forEach((item, index) => {
                    resultHtml += `<li onclick="viewStudyContent(${studyContents.indexOf(item)})">${item.title}</li>`;
                });
                resultHtml += '</ul>';
            }

            document.getElementById('mainContent').innerHTML = resultHtml;
            pushState(resultHtml);
        }

        function pushState(content) {
            history.pushState({content: content}, "", "");
            document.getElementById('mainContent').innerHTML = content;
        }

        window.onpopstate = function(event) {
            if (event.state) {
                document.getElementById('mainContent').innerHTML = event.state.content;
            }
        };

        function showSummaryForm(topic) {
            document.getElementById('mainContent').innerHTML = `
                <h3>${topic} 요약 추가</h3>
                <input type="text" id="summaryURL" placeholder="URL을 입력하세요">
                <div class="button-container">
                    <button onclick="fetchAndSummarize('${topic}')">요약</button>
                </div>
            `;
        }

        function fetchAndSummarize(topic) {
            const url = document.getElementById('summaryURL').value;
            fetch(url)
                .then(response => response.text())
                .then(data => {
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(data, 'text/html');
                    const textContent = doc.body.innerText.split('\n').slice(0, 20).join('\n');
                    saveStudyContentFromSummary(topic, textContent);
                })
                .catch(error => console.error('Error fetching URL:', error));
        }

        function saveStudyContentFromSummary(topic, content) {
            const title = "요약 내용";
            studyContents.push({topic, title, content});
            localStorage.setItem('studyContents', JSON.stringify(studyContents));
            showStudyList(topic);
        }

        showContent('이 홈페이지는 글쓰고, 올리고, 지울려고 만드는 사이트 입니다.');

        // 뒤로 가기 기능 추가 (이 기능을 사용하기 위해 이벤트 리스너를 수정합니다)
        document.addEventListener('keydown', function(event) {
            if (event.key === "Backspace" && !event.target.matches('input, textarea')) {
                event.preventDefault(); // 기본 동작 방지
                window.history.back(); // 뒤로 가기 실행
            }
        });
    </script>
</body>
</html>


